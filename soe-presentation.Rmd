---
title: "State of the Ecosystem:"
subtitle: "Reporting on Northeast Continental Shelf<br> ecosystem status and trends."
author: "Sean Hardison<br /> Ecosystem Dynamics and Assessment <br /> Northeast Fisheries Science Center"
output:
  xaringan::moon_reader:
    css: ["default", "libs/my-theme.css"]
    lib_dir: libs
    nature:
      titleSlideClass: ["right", "middle", "my-title"]
      highlightStyle: githubp
      highlightLines: true
      countIncrementalSlides: false
  revealjs::revealjs_presentation:
    self_contained: false
    reveal_plugins: ["notes", "search"]
---
class: top, left

```{r setup, include=FALSE}
options(htmltools.dir.version = FALSE)
#Plotting and data libraries
library(ggplot2)
library(dplyr)
library(tidyr)
library(ecodata)
library(here)
library(kableExtra)
library(ggrepel)
library(stringr)
library(patchwork)
library(grid)
library(ggiraph)
library(vegan)
library(rpart)

#GIS libraries
library(sf)
library(rgdal)
library(raster)
library(rnaturalearth)

data.dir <- here::here("data")


#Time series constants
shade.alpha <- 0.3
shade.fill <- "lightgrey"
lwd <- 1
pcex <- 2
trend.alpha <- 0.5
trend.size <- 2
hline.size <- 1
hline.alpha <- 0.35
hline.lty <- "dashed"
label.size <- 5
hjust.label <- 1.5
letter_size <- 4
feeding.guilds <- c("Apex Predator","Piscivore","Planktivore","Benthivore","Benthos")
x.shade.min <- 2009
x.shade.max <- 2018
map.lwd <- 0.4
#Function for custom ggplot facet labels
label <- function(variable,value){
  return(facet_names[value])
}

```

# Today's seminar

.pull-left[

- Ecosystem Reporting and why it matters

- Functional role of ecosystem reporting in the Northeast US

- Report structure

- Highlights from the 2019 Mid-Atlantic and New England reports

- Strategies for open-source reporting
]

.pull-right[
*The IEA Loop<sup>1</sup>*
![iea-loop](images/iea-loop.png)


]

.footnote[
[1] https://www.integratedecosystemassessment.noaa.gov/national/IEA-approach
]

???
Today I'm going to be talking to you first about ecosystem reporting, specifically what is it and why does it matter

---

## Ecosystem-Based Management

.pull-left[
* Place-based management of all human ecosystem uses, or **sectors**<sup>1</sup>

  * "Cross-sectoral" 
  
  * Scale of "place" defined by scale of impacts

]

.pull-right[

```{r ebm-sectors, fig.align="center", out.width = "100%", echo = F}
knitr::include_graphics("images/ebm-sectors.png")
```

]


.footnote[
[1] Agardy, Tundi, et al. "Taking steps toward marine and coastal ecosystem-based management: An introductory guide." (2011).


[2] Patrick, Wesley S., and Jason S. Link. "Myths that continue to impede progress in ecosystem-based fisheries management." Fisheries 40.4 (2015): 155-160.
]

## Ecosystem-Based Fishery Management

* Integrated management of a **single-sector** (i.e. fisheries)
* Considers trade-offs of management strategies on ecosystem components<sup>2</sup>



```{r ebfm-single-sector, fig.align="center", out.width = "50%", echo = F}
knitr::include_graphics("images/ebfm-single-sector.png")
```

???
Under EBM, the idea is that these "sectors" must be managed in an integrated fashion, where impacts of each sector on the ecosystem can be assessed and managed with respect to objectives

---
# Integrated Ecosystem Assessment (IEA)

**A framework for synthesis and analysis of natural, social, and economic factors that are relevant to established ecosystem management objectives<sup>1</sup>**

.pull-right[
.footnote[
[1] Levin, Phillip S., et al. "Integrated ecosystem assessments: developing the scientific basis for ecosystem-based management of the ocean." PLoS biology 7.1 (2009): e1000014.

]
]
--

![iea-loop-explanations](images/iea-loop-explanation.png)
*The IEA Loop*

???
Before jumping in I'm going to start with some definitions of terms that you'll be hearing a lot of. The first is Integrated Ecosystem Assessmentor (IEA).

IEA is defined as a framework for the synthesis and analysis of relevant natural, social, and economic factors that are relevant to established management objectives.

IEA has been embraced on a nationwide scale by NOAA fisheries, and is a method for moving towards Ecosystem-Based Management for natural resources. 

It's an iterative process, hence, "the loop", and starts with the establishment of management goals by fishery management councils. 

Once objectives are defined, we develop indicators that allow us to quantify and report on the status and trends of ecosystem processes. 

Next we work with management bodies to identify sources of risk in ecosystems that threaten the achievement of management goals, and then we use modeling techniques to evaluate how certain management strategies could propagate through the system. 

Today I'm going to be talking to you about the ecosystem reporting phase of this process. 

---

## Ecosystem Status Reporting (ESR)

Ecosystem reporting provides a route for ecosystem information to enter the stock assessment process

* Well-developed example is AFSC; whose ESRs have long served as context for North Pacific FMC quota 
deliberations<sup>1</sup>

All IEA regions in the US develop similar documents in varying guises


.footnote[
[1] Zador, Stephani G., et al. "Ecosystem considerations in Alaska: the value of qualitative assessments." ICES Journal of Marine Science 74.1 (2017): 421-430.
]

--

.pull-left[
*IEA Regions*
![iea-region](images/iea-regions.png)
]

.pull-right[
*Ecosystem Status Reports*
![regional-esrs](images/esr-breakdown.png)
]


???

---
## Classes of ecosystem information

```{r nes-comp1, echo = F}
knitr::include_graphics("images/nes-components.png")
```

---

## Goals of ESR:

* Identify changes in ecosystem component status (short-term) and trend (long-term)

* Identify potential for changes to affect management concerns

* Highlight "red flags" and potential ecosystem state changes

Mike's diagram


---

## ESRs in the Northeast US: Relevance to management

**Why should managers care about an ecosystem perspective to resource management?**

--

Well-informed management decisions rely upon knowledge of the ecosystem being managed

--

An ecosystem perspective is important for managing in the face of rapid, unprecedented ecosystem changes

.pull-left[

```{r long-term sst, echo = F, fig.height=4}

lt_sst <- ecodata::long_term_sst %>% 
  mutate(hline = mean(Value))

lt_sst %>% 
  ggplot(aes(x = Time, y = Value, group = Var)) +
         annotate("rect", fill = shade.fill, alpha = shade.alpha,
      xmin = x.shade.min , xmax = x.shade.max,
      ymin = -Inf, ymax = Inf) +
  geom_gls() +
  geom_line() +
  geom_point() +
  ylab("Temperature (°C)") +
  # ggtitle("") +
    scale_x_continuous(expand = c(0.01, 0.01), breaks = seq(1840,2010,20))+
      geom_hline(aes(yintercept = hline),
           size = hline.size,
           alpha = hline.alpha,
           linetype = hline.lty)+
  theme_facet() +
  theme(strip.text=element_text(hjust=0,
                                face = "italic"))

```
*NE Shelf Long-term SST*
]

.pull-right[
```{r GSI, fig.height = 4, echo = F}
gsi %>% 
  mutate(Year = floor(Time)) %>% 
  group_by(Year) %>% 
  dplyr::summarise(Value = mean(Value)) %>% 
  mutate(hline = mean(Value)) %>% 
  dplyr::rename(Time = Year) %>% 
  ggplot(aes(x = Time, y = Value)) +
         annotate("rect", fill = shade.fill, alpha = shade.alpha,
      xmin = x.shade.min , xmax = x.shade.max,
      ymin = -Inf, ymax = Inf) +
  geom_gls() +
  geom_line() +
  geom_point() +
  ylab("Gulf Stream position anomaly") +
  # ggtitle("") +
    scale_x_continuous(expand = c(0.01, 0.01))+
      geom_hline(aes(yintercept = hline),
           size = hline.size,
           alpha = hline.alpha,
           linetype = hline.lty)+
  theme_ts() +
  theme(strip.text=element_text(hjust=0,
                                face = "italic"))
```
*Gulf Stream Index*
]

---

## ESRs in the Northeast US: Relevance to management

Ecosystem conditions affect fisheries yield 

By providing ESRs to managers, we continue to move towards Ecosystem-based Management strategies to meet sustainability and conservationist goals laid out by the Magnuson-Stevens Act.

* Marine ecosystems in high productivity states may be more resilient to extractive pressures and climate change than those in lower productivity states.
  - EBFM is a way to meet ecosystem objectives while remaining sustainable 






---

## ESR in the Northeast US

ESRs developed by NEFSC since 2009

Considerable support for EAFM exists in Northeast
* Most FMC council members in the Northeast support transitioning from a single-species to a multi-species ecosystem approach (i.e. EBFM) to management<sup>1</sup>

--

Common refrain upon recieving ESR:
# "So what"?


.footnote[
Biedron, Ingrid S., and Barbara A. Knuth. "Toward shared understandings of ecosystem-based fisheries management among fishery management councils and stakeholders in the US Mid-Atlantic and New England regions." Marine Policy 70 (2016): 40-48.
]

---

## Problems with ESR model:

* Council members are busy people!

  * Long-documents with unfamiliar information unlikely to connect
  
* Not all Council members have science background

* "What does chlorophyll concentration tell us about fisheries yields?"

The disconnect inspired a new model, which we call **State of the Ecosystem (SOE)** reports

---

## SOE Reporting: Ecosystem science for busy people

Addressing critiques to ESR model in SOE

1. Clear alignment of ecosystem components with management objectives

1. Objectives related to human-well being placed first in report

1. Non-technical text

1. Short (< 30 pages), but rigorous

1. Emphasis on reproducibility 

```{r nes-comp2, echo = F, out.width = "60%", fig.align = "center"}
knitr::include_graphics("images/nes-components-abstracted.png")
```

???
In 2016, we began taking steps to address these common critiques of the ESR model

---
So I'd like to now present the results of this year's State of the Ecosystem reports

---
# SOE Report: Mid-Atlantic Bight



---
# SOE Report: New England

---

## SOE reporting: quantifying change

Status (short-term) and trend (long-term) of components are measured as **indicators**

Indicators are selected to

1. Be broadly informative about a component in a management context<sup>1-3</sup>

1. Minimize redundancy of information

1. Be responsive to ecosystem change


.footnote[
[1] Rice J. C.Rochet M. J. "A framework for selecting a suite of indicators for fisheries management." ICES Journal of Marine Science 62 (2005): 516–527.

[2] Link J. 2010. Ecosystem-Based Fisheries Management: Confronting Tradeoffs . Cambridge University Press, New York.

[3] Zador, Stephani G., et al. "Ecosystem considerations in Alaska: the value of qualitative assessments." ICES Journal of Marine Science 74.1 (2017): 421-430.
]

--

```{r, echo = F, fig.align = "center", fig.height = 3, fig.width=8}

#Filter data into two dataframes for plotting
indicators <- ecodata::bennet %>% 
  filter(EPU %in% "GB",
         Var %in% c("VI EPU aggregate",
                    "PI EPU aggregate")) %>% 
  mutate(Var, Var = plyr::mapvalues(Var, from = c("VI EPU aggregate","PI EPU aggregate"),
                                    to = c("Volume","Price")))

revchange <- ecodata::bennet %>% 
  filter(EPU %in% "GB",
         Var %in% c("REVCHANGE EPU aggregate"))

#custom bar fill color (color-blind friendly)
ind_fill <- c("#a6cee3", "#b2df8a")

#limits
y.lim <- c(-350,350)

#plot
gb_bennet <- indicators %>%
ggplot()+
  
  #Highlight last ten years
  annotate("rect", fill = shade.fill, alpha = shade.alpha,
      xmin = x.shade.min , xmax = x.shade.max,
      ymin = -Inf, ymax = Inf)+
  
  geom_bar(aes(x=Time, y= Value, fill = Var), stat="identity")+
  scale_fill_manual(name = "Indicators", values = ind_fill) +
  geom_line(data = revchange[revchange$EPU == "GB",], aes(x = Time, y = Value, colour="$"))+
  scale_colour_grey(name ="Revenue Change") +
  ggtitle("Georges Bank Commercial Landings")+
  labs(y="Value $1,000,000 ($2015)") +
  scale_x_continuous(breaks = seq(1965, 2015, by = 10), expand = c(0.01, 0.01)) +
  scale_y_continuous(breaks = seq(y.lim[1], y.lim[2], by = 100), limits = y.lim, expand = c(0.01, 0.01)) +
  theme_ts() +
  theme(title = element_text(size = 10))

gb_bennet

```





---
## SOE reporting: ecosystem indicators

```{r management-objectives, echo = F}

mng_obj <- data.frame("Objective Categories" = c("Seafood Production",
                                                 "Profits","Recreation",
                                                 "Stability","Social & Cultural",
                                                 "Biomass","Productivity",
                                                 "Trophic structure","Habitat"),
"Indicators" = c("Landings by feeding guild","Revenue by feeding guild",
                               "Number of anglers and trips; recreational catch",
                               "Diversity indices (fishery and species)",
                               "Commercial and recreational reliance",
                 "Biomass or abundance by feeding guild from surveys",
                               "Condition and recruitment of managed species",
                               "Relative biomass of feeding guilds, primary productivity",
                               "Estuarine and offshore habitat conditions"))

knitr::kable(mng_obj,
      col.names = c("Objective Categories","Indicators"),
      caption = "Ecosystem-scale objectives and indicators on the Northeast US shelf") %>%
  kableExtra::kable_styling(full_width = F) %>%
 # column_spec(c(2), width = c("25em")) %>%
  row_spec(0, bold = TRUE)
```

---
## SOE reporting: indicator spatial scales

```{r EPU-MAP, eval  = F, echo = F}
crs <- "+proj=longlat +lat_1=35 +lat_2=45 +lat_0=40 +lon_0=-77 +x_0=0 +y_0=0 +datum=NAD83 +no_defs +ellps=GRS80 +towgs84=0,0,0"

#Coastline shapefile
coast <- ne_countries(scale = 10,
                          continent = "North America",
                          returnclass = "sf") %>%
             sf::st_transform(crs = crs)

#State polygons
ne_states <- ne_states(country = "united states of america",
                                      returnclass = "sf") %>%
  sf::st_transform(crs = crs)

load(file.path(data.dir, "epu_no_estuaries.rdata"))

# Set lat/lon window for map
xmin = -77
xmax = -65
ymin = 36
ymax = 45
xlims <- c(xmin, xmax)
ylims <- c(ymin, ymax)

#CRS
crs <- "+proj=longlat +lat_1=35 +lat_2=45 +lat_0=40 +lon_0=-77 +x_0=0 +y_0=0 +datum=NAD83 +no_defs +ellps=GRS80 +towgs84=0,0,0"

#Specify data frame with lat/lon locations for labels
epu_labels <- data.frame(EPU = c("Mid-Atlantic\n Bight",
                                 "Gulf of Maine",
                                 "Georges Bank"),
                         latitude = c(40,42.85,41),
                         longitude = c(-72.55,-69,-68.5))

#Map of NE LME
 
  ggplot() +
  geom_sf(data = epu_sf, aes(fill = EPU), size = map.lwd) +
  geom_sf(data = coast, size = map.lwd) +
  
  coord_sf(crs = crs, xlim = xlims, ylim = ylims) +
  geom_text(data = epu_labels, aes(x = longitude,
                                    y = latitude,
                                    label = EPU),
            size = 4.5)+
  guides(fill = FALSE) +
  scale_fill_brewer() +
  theme_map() +
  ggtitle("Ecological Production Units on the Northeast Shelf") +
  xlab("Longitude") +
  ylab("Latitude")

```

.left-column[
* Indicators reported on coastwide to state-level scale

* Georges Bank and Gulf of Maine are reported in New England document

]

.right-column[
```{r epu-map-image, fig.align = "center", echo = F, fig.height = 6}
knitr::include_graphics("images/epu-layout.png")
```
]

---
